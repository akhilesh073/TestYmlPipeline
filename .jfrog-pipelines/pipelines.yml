resources:
  - name: triggerLightWeightAutomation
    type: PropertyBag
    configuration:
      jpdUrl: ''
      joinKey: ''
      branchPipelinesVersion: ''
  - name: environmentSetupBag
    type: PropertyBag
    configuration:
      pipelinesVersion: ''
      serverName: ''
      masterKey: ''
  - name: environmentOperateBag
    type: PropertyBag
    configuration:
      pipelinesVersion: ''
      serverName: ''
  - name: branchSnapshotBag
    type: PropertyBag
    configuration:
      snapshotVersion: ''
  - name: cpGit
    type: GitRepo
    configuration:
      path: akhilesh073/TestYmlPipeline
      gitProvider: testInt
name: branch_automation_setup
configuration:
  environmentVariables:
    readOnly:
      NAMESPACE_PREFIX:
        allowCustom: true
        default: p
      ADMIN_USER: admin
      ADMIN_PASSWORD: password
steps:
  - name: decide_whether_to_create_or_update_dev2cloud
    type: Bash
    configuration:
      inputResources:
        - name: branchSnapshotBag
        - name: cpGit
          trigger: true
      outputResources:
        - name: environmentSetupBag
        - name: environmentOperateBag
        - name: triggerLightWeightAutomation
    execution:
      onExecute:
        - printenv
  - name: branch_environment_setup
    type: Jenkins
    configuration:
      inputResources:
        - name: environmentSetupBag
      jenkinsJobName: tools/platform/environment_setup
